{
 "build_module" : "",
 "items" : [
  {
   "# JsRender.NodePropType ptype" : "",
   "$ xns" : "Gtk",
   "@ void select" : "(JsRender.NodeProp prop)",
   "Gtk.PositionType position" : "Gtk.PositionType.RIGHT",
   "Xcls_MainWindow mainwindow" : "",
   "bool active" : false,
   "bool hexpand" : false,
   "bool modal" : true,
   "id" : "PopoverAddProp",
   "int height_request" : 800,
   "int width_request" : 900,
   "items" : [
    {
     "$ shadow_type" : "Gtk.ShadowType.IN",
     "$ xns" : "Gtk",
     "* init" : [
      "    this.el.set_policy (Gtk.PolicyType.AUTOMATIC, Gtk.PolicyType.AUTOMATIC);",
      " "
     ],
     "* pack" : "add",
     "items" : [
      {
       "$ enable_tree_lines" : true,
       "$ headers_visible" : true,
       "$ xns" : "Gtk",
       "* init" : [
        "{  ",
        "       var description = new Pango.FontDescription();",
        "     description.set_size(10000);",
        "    this.el.override_font(description);     ",
        "                    ",
        "    this.el.get_selection().set_mode( Gtk.SelectionMode.SINGLE);",
        " ",
        "",
        "    ",
        "  ",
        "    ",
        "}",
        ""
       ],
       "* pack" : "add",
       "items" : [
        {
         "$ columns" : [
          "",
          "typeof(JsRender.NodeProp),  // 0 real key",
          "typeof(string),  // text display",
          "typeof(string),  // tooltip",
          "typeof(string)  // sortable string",
          "",
          "// add later? source?",
          "/* was:",
          "typeof(string),  // 0 real key",
          "typeof(string), // 1 real type",
          "typeof(string), // 2 docs ?",
          "typeof(string), // 3 visable desc",
          "typeof(string), // 4 function desc",
          "typeof(string) // 5 element type (event|prop)",
          "*/"
         ],
         "$ xns" : "Gtk",
         "* pack" : "set_model",
         "id" : "model",
         "n_columns" : 4,
         "xtype" : "ListStore",
         "| JsRender.NodeProp getValue" : [
          "(Gtk.TreeIter iter, int col)",
          "{",
          "",
          "    GLib.Value value;",
          "    this.el.get_value(iter, col, out value);",
          " ",
          "    return (JsRender.NodeProp)value;",
          "    ",
          "}"
         ]
        },
        {
         "$ xns" : "Gtk",
         "* init" : [
          "  this.el.add_attribute(_this.namerender.el , \"markup\", 1  );",
          " ",
          ""
         ],
         "* pack" : "append_column",
         "id" : "namecol",
         "items" : [
          {
           "$ xns" : "Gtk",
           "* pack" : "pack_start,true",
           "id" : "namerender",
           "xtype" : "CellRendererText"
          }
         ],
         "utf8 title" : "Double click to add",
         "xtype" : "TreeViewColumn"
        }
       ],
       "listeners" : {
        "row_activated" : [
         "(path, column)  => {",
         "",
         "\tGtk.TreeIter iter;",
         "",
         "",
         "\tvar m = _this.model;",
         "",
         "\tm.el.get_iter(out iter,path);",
         "",
         " ",
         "\tvar prop = m.getValue(iter, 0);",
         " ",
         "",
         "\t// hide the popover",
         "\t_this.el.hide();",
         "\t ",
         "\t",
         "\t_this.select(prop);",
         " ",
         "}",
         " "
        ]
       },
       "tooltip_column" : 2,
       "xtype" : "TreeView"
      }
     ],
     "xtype" : "ScrolledWindow"
    }
   ],
   "xtype" : "Popover",
   "| void clear" : [
    "() {",
    " this.model.el.clear();",
    "}",
    ""
   ],
   "| void hide" : [
    "() {",
    "\tthis.ptype = JsRender.NodePropType.NONE;",
    "\tthis.el.hide();",
    "}",
    ""
   ],
   "| void show" : [
    "(Palete.Palete pal, JsRender.NodePropType ptype, string xtype,  Gtk.Widget onbtn) {",
    "",
    "    /// what does this do?",
    "    //if (this.prop_or_listener  != \"\" && this.prop_or_listener == prop_or_listener) {",
    "    //\tthis.prop_or_listener = \"\";",
    "    //\tthis.el.hide();",
    "    //\treturn;",
    "\t//}",
    "\t",
    "\t",
    "\t",
    "    this.ptype = ptype;",
    "    ",
    "    this.model.el.clear();",
    "",
    "    Gtk.TreeIter iter;",
    "    var elementList = pal.getPropertiesFor( xtype, ptype);",
    "     ",
    "    //print (\"GOT \" + elementList.length + \" items for \" + fullpath + \"|\" + type);",
    "           // console.dump(elementList);",
    "           ",
    "    var miter = elementList.map_iterator();",
    "    while (miter.next()) {",
    "       var p = miter.get_value();",
    "        ",
    "        this.model.el.append(out iter);",
    "\t\t",
    "\t\tvar prop = p.toNodeProp();",
    "\t\t",
    "\t \t ",
    "",
    "        this.model.el.set(iter,",
    "                0,  prop, ",
    "                1,  prop.to_property_option_markup(),",
    "                2,  prop.to_property_option_tooltip(),                ",
    "                3,  prop.name,                ",
    "                -1",
    "        );",
    "    }",
    "    this.model.el.set_sort_column_id(3,Gtk.SortType.ASCENDING);    ",
    "    ",
    "    // set size up...",
    "    ",
    "",
    "    int w,h;",
    "    this.mainwindow.el.get_size(out w, out h);",
    "    ",
    "    // left tree = 250, editor area = 500?",
    "    ",
    "    // min 450?",
    "\t// max hieght ...",
    "    this.el.set_size_request( 250, h);",
    "",
    "    ",
    "",
    "    if (this.el.relative_to == null) {",
    "        this.el.set_relative_to(onbtn);",
    "    }",
    "    this.el.show_all();",
    "   ",
    "    while(Gtk.events_pending()) { ",
    "            Gtk.main_iteration();   // why?",
    "    }       ",
    " //   this.hpane.el.set_position( 0);",
    "}",
    ""
   ]
  }
 ],
 "modOrder" : "",
 "name" : "PopoverAddProp",
 "parent" : "",
 "path" : "/home/alan/gitlive/roobuilder/src/Builder4/PopoverAddProp.bjs",
 "permname" : "",
 "title" : ""
}